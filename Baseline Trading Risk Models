# core/models.py
from pydantic import BaseModel, Field
from typing import List, Optional, Dict
from enum import Enum
from datetime import datetime

class AssetType(str, Enum):
    EQUITY = "equity"
    BOND = "bond"
    ETF = "etf"
    FUTURE = "future"
    SWAP = "swap"
    FX = "fx"

class Position(BaseModel):
    position_id: str
    account_id: str
    instrument_id: str   # FIGI/ISIN
    asset_type: AssetType
    quantity: float
    notional: float
    side: str  # "long" or "short"
    valuation: float  # mark
    currency: str
    timestamp: datetime

class FinancingOffer(BaseModel):
    offer_id: str
    counterparty: str
    instrument_id: str
    rate: float  # annualized
    tenor_days: int
    collateral_type: Optional[str]
    haircuts: Optional[float]
    timestamp: datetime

class Recommendation(BaseModel):
    rec_id: str
    run_id: str
    created_at: datetime
    type: str  # e.g., "refinance", "rebalance", "hedge"
    description: str
    actions: List[Dict]  # Execution-level actions
    expected_pnl: float
    expected_rwa_delta: float
    confidence: float  # 0..1
    provenance: Dict
